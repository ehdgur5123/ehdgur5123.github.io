---
layout: single
title: "14) Broken Authentication"
categories: Security
tag: [Security]
permalink : /posts/Security-14/
toc: true
classes: custom-style
author_profile: false
sidebar:
  nav: "Security"
---

<hr>

# Broken Authentication이란 무엇인가?

## 개요

**Broken Authentication**은 웹 애플리케이션의 **인증 및 세션 관리** 기능에서 발생하는 **취약점**으로, 사용자 인증이 제대로 작동하지 않아 <u>공격자가 다른 사용자로 가장할 수 있게 만드는 보안 문제</u>입니다. 이 취약점은 웹 애플리케이션이 사용자의 자격 증명을 보호하지 못하거나, 세션 관리가 부적절하게 이루어질 때 발생하며, 인증 시스템을 우회하여 민감한 정보에 접근하거나 계정을 탈취할 수 있습니다.

**OWASP(오픈 웹 애플리케이션 보안 프로젝트)**에 따르면, Broken Authentication은 웹 애플리케이션에서 발생하는 주요 보안 취약점 중 하나입니다. 이는 공격자가 임의로 다른 사용자 계정을 제어하거나 중요 데이터에 접근할 수 있게 만들기 때문에 심각한 보안 사고로 이어질 수 있습니다.

## Broken Authentication의 원인

Broken Authentication은 주로 아래와 같은 이유로 발생합니다

1. <b>약한 비밀번호 정책</b>: 사용자가 너무 짧거나 예측 가능한 비밀번호를 설정하도록 허용할 때, 공격자는 이를 쉽게 추측하거나 사전 공격(Dictionary Attack)을 통해 접근할 수 있습니다.

1. <b>자격 증명 전송 보호 미흡</b>: HTTPS 대신 HTTP로 로그인 자격 증명(아이디, 비밀번호 등)이 전송될 경우, 네트워크 상에서 이 정보가 가로채질 수 있습니다. 이로 인해 공격자는 **중간자 공격**(Man-in-the-Middle Attack)을 통해 데이터를 탈취할 수 있습니다.

1. <b>세션 관리 취약점</b>: **세션 토큰**이 유출되거나 재사용될 수 있거나, 세션 만료 시간이 너무 길면 공격자가 이를 이용해 인증된 사용자로 가장할 수 있습니다. 이는 **세션 고정**(Session Fixation) 또는 **세션 하이재킹**(Session Hijacking)과 같은 공격으로 이어질 수 있습니다.

1. <b>브루트포스 공격 방지 미흡</b>: 계정 잠금 정책이 부재하거나 비밀번호 시도 횟수에 제한이 없을 경우, 공격자는 다양한 비밀번호 조합을 시도하는 **브루트포스 공격(Brute Force Attack)**을 통해 계정을 탈취할 수 있습니다.

1. <b>비밀번호 재설정 메커니즘의 취약점</b>: 비밀번호 재설정 기능에서 질문과 답변이 예측 가능하거나, 재설정 링크가 쉽게 조작될 수 있다면 공격자는 이를 악용하여 사용자의 비밀번호를 변경할 수 있습니다.

## Broken Authentication의 주요 공격 유형

1. **크리덴셜 스터핑**(Credential Stuffing): 사용자들이 여러 웹사이트에서 동일한 비밀번호를 사용하는 경우, 공격자는 유출된 자격 증명(아이디와 비밀번호)을 여러 웹사이트에서 자동화된 도구로 시도하여 로그인할 수 있습니다. 이는 데이터 유출 사건에서 특히 자주 발생합니다.

1. **브루트포스 공격**(Brute Force Attack): 공격자가 여러 비밀번호 조합을 무차별적으로 시도하여 올바른 자격 증명을 찾는 방법입니다. 비밀번호 길이와 복잡도가 낮으면 이 공격에 매우 취약합니다.

1. **세션 하이재킹**(Session Hijacking): 공격자가 사용자의 세션 토큰을 탈취하여 해당 사용자의 세션에 접근하는 공격입니다. 공격자는 네트워크 상에서 세션 토큰을 가로채거나, 애플리케이션에서 세션 토큰이 노출되는 취약점을 이용할 수 있습니다.

1. **세션 고정**(Session Fixation): 공격자가 특정 세션 ID를 사용하도록 유도하여 사용자가 해당 세션에 로그인하면, 공격자가 동일한 세션 ID를 통해 해당 사용자로 가장할 수 있습니다.

## Broken Authentication의 위험성

Broken Authentication은 매우 심각한 보안 취약점으로, 공격자가 이를 악용하여 인증된 사용자로 가장할 수 있습니다. 그 결과, 다음과 같은 위험이 발생할 수 있습니다

- <b>계정 탈취</b>: 공격자는 사용자의 계정에 로그인하여 민감한 데이터를 열람하거나, 피해자 대신 계정을 악용할 수 있습니다.

- <b>개인 정보 유출</b>: 공격자가 다른 사용자의 계정에 접근할 수 있다면, 개인 정보가 유출될 위험이 있습니다.

- <b>서비스 남용</b>: 공격자는 관리자의 권한을 가진 계정을 탈취하여 시스템 전체를 제어하거나, 서비스에 악성 코드를 심어 전체 사용자에게 영향을 미칠 수 있습니다.

## Broken Authentication의 방어 방법

1. <b>강력한 비밀번호 정책</b>: 비밀번호는 최소 8자 이상의 복잡한 조합(대문자, 소문자, 숫자, 특수문자)을 요구하고, 너무 간단한 비밀번호는 허용하지 않는 것이 좋습니다. 또한, 사용자가 동일한 비밀번호를 여러 사이트에서 재사용하지 않도록 경고하는 것도 중요합니다.

1. <b>이중 인증(2FA)</b>: 추가적인 보안 계층으로 이중 인증(2단계 인증)을 도입하면, 비밀번호가 유출되더라도 공격자가 추가 인증 없이 계정에 접근하기 어렵습니다.

1. <b>비밀번호 재사용 금지</b>: 사용자가 이전에 사용한 비밀번호를 재사용하지 못하도록 정책을 설정해야 합니다. 이를 통해 유출된 자격 증명을 사용하는 공격을 방지할 수 있습니다.

1. <b>세션 관리 강화</b>: 세션 토큰은 난수로 생성되며 추측이 불가능해야 합니다. 또한, 사용자가 로그아웃하거나 일정 시간 동안 활동이 없을 경우 세션이 자동으로 만료되도록 설정하는 것이 중요합니다.

1. <b>계정 잠금 및 알림 기능</b>: 비밀번호를 여러 번 잘못 입력했을 때 계정을 잠그는 기능을 통해 브루트포스 공격을 방지할 수 있습니다. 또한, 비밀번호 변경이나 로그인 시도에 대한 알림을 사용자에게 제공하여 의심스러운 활동을 인지할 수 있게 해야 합니다.

1. <b>HTTPS 사용</b>: 모든 로그인과 인증 관련 통신은 HTTPS를 통해 암호화되어야 합니다. 이를 통해 네트워크 상에서 자격 증명이 가로채질 위험을 방지할 수 있습니다.

1. <b>비밀번호 재설정 프로세스 강화</b>: 비밀번호 재설정 링크는 일회용으로 사용해야 하며, 일정 시간 후에 만료되도록 설정해야 합니다. 또한, 이메일 또는 휴대폰 인증을 통한 추가적인 확인 절차가 필요합니다.

## 결론

Broken Authentication은 웹 애플리케이션에서 발생할 수 있는 치명적인 보안 취약점으로, 이를 방치할 경우 사용자의 계정이 공격자의 손에 넘어갈 수 있습니다. 강력한 인증 메커니즘을 구축하고, 이중 인증, 세션 관리 강화, 비밀번호 정책 개선 등의 방어 조치를 통해 Broken Authentication 문제를 예방할 수 있습니다.