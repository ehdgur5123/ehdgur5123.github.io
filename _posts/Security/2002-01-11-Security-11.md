---
layout: single
title: "11) Burpsuite Intercept"
categories: Security
tag: [Security]
permalink : /posts/Security-11/
toc: true
classes: custom-style
author_profile: false
sidebar:
  nav: "Security"
---

<hr>

# Burpsuite μΈν„°μ…‰νΈ

**Burp Suite**μ **Intercept** κΈ°λ¥μ€ **μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…κ³Ό ν΄λΌμ΄μ–ΈνΈ(μ£Όλ΅ μ›Ή λΈλΌμ°μ €) κ°„μ HTTP/HTTPS μ”μ²­κ³Ό μ‘λ‹µμ„ κ°€λ΅μ±„κ³  μμ •ν•  μ μλ” λ„κµ¬**μ…λ‹λ‹¤. λ³΄μ• λ¶„μ„κ°€λ‚ μ¤λ¦¬μ  ν•΄μ»¤λ” μ΄ κΈ°λ¥μ„ μ‚¬μ©ν•΄ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ£Όκ³ λ°›λ” λ°μ΄ν„°λ¥Ό μ‹¤μ‹κ°„μΌλ΅ λ¨λ‹ν„°λ§ν•κ³ , μ”μ²­μ΄λ‚ μ‘λ‹µμ„ μμ •ν•μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ λ³΄μ• μ·¨μ•½μ μ„ νƒμƒ‰ν•  μ μμµλ‹λ‹¤.

# Interceptμ μ‘λ™ λ°©μ‹

1. **μΈν„°μ…‰νΈ μ„¤μ •**: Interceptλ¥Ό ν™μ„±ν™”ν•λ©΄ λΈλΌμ°μ €μ—μ„ μ„λ²„λ΅ λ³΄λ‚΄λ” λ¨λ“  μ”μ²­μ΄ Burp Suiteμ— μν•΄ κ°€λ΅μ±„μ§‘λ‹λ‹¤. μ΄λ• μ‚¬μ©μλ” μ”μ²­μ„ μ„λ²„μ— μ „λ‹¬ν•κΈ° μ „μ— μμ •ν•κ±°λ‚, κ²€ν† ν• λ’¤ κ·Έλ€λ΅ μ„λ²„λ΅ μ „λ‹¬ν•  μ μμµλ‹λ‹¤.

2. **μ”μ²­/μ‘λ‹µ μμ •**: Intercept κΈ°λ¥μ„ ν†µν•΄ κ°€λ΅μ± μ”μ²­μ΄λ‚ μ‘λ‹µμ€ Burp Suiteμ νΈμ§‘ ν™”λ©΄μ—μ„ μμ •ν•  μ μμµλ‹λ‹¤. νλΌλ―Έν„°, ν—¤λ”, μΏ ν‚¤, URL λ“±μ„ λ³€κ²½ν•μ—¬ μ„λ²„κ°€ μμƒν•μ§€ λ»ν• λ°©μ‹μΌλ΅ λ™μ‘ν•κ² ν•  μ μμΌλ©°, μ΄λ¥Ό ν†µν•΄ μ• ν”λ¦¬μΌ€μ΄μ…μ λ°μ‘μ„ ν…μ¤νΈν•©λ‹λ‹¤.

3. **μ”μ²­ νλ¦„ μ μ–΄**: μ‚¬μ©μκ°€ μμ •ν• ν›„ `Forward` λ²„νΌμ„ ν΄λ¦­ν•λ©΄ μ”μ²­μ΄ μ„λ²„λ΅ μ „μ†΅λλ©°, `Drop` λ²„νΌμ„ ν΄λ¦­ν•λ©΄ μ”μ²­μ΄ μ·¨μ†λ©λ‹λ‹¤. Forwardμ™€ Drop κΈ°λ¥μ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ ν†µμ‹  νλ¦„μ„ μ μ–΄ν•  μ μμµλ‹λ‹¤.

4. **μ‘λ‹µ κ°€λ΅μ±„κΈ°**: Intercept κΈ°λ¥μ€ μ”μ²­λΏλ§ μ•„λ‹λΌ μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ λμ•„μ¤λ” μ‘λ‹µλ„ κ°€λ΅μ± μ μμµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ„λ²„μ μ‘λ‹µ λ‚΄μ©μ„ μμ •ν•΄ ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•  μ μμµλ‹λ‹¤.

# Intercept μ£Όμ” ν™μ© λ¶„μ•Ό

1. **λ§¤κ°λ³€μ μ΅°μ‘**: Interceptλ¥Ό ν†µν•΄ HTTP μ”μ²­μ νλΌλ―Έν„° κ°’μ„ μ‹¤μ‹κ°„μΌλ΅ μ΅°μ‘ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, κ°€κ²© μ •λ³΄κ°€ ν¬ν•¨λ νλΌλ―Έν„°λ¥Ό μμ •ν•΄ μ„λ²„μ μ‘λ‹µμ΄ μ–΄λ–»κ² λ³€ν•λ”μ§€ ν…μ¤νΈν•  μ μμµλ‹λ‹¤. μ΄λ΅ μΈν•΄ κ°€κ²© λ³€λ™μ΄λ‚ μ ‘κ·Ό κ¶ν• μ°ν λ“±μ λ³΄μ• μ·¨μ•½μ μ΄ μλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

2. **μΈμ¦ λ° μ„Έμ… ν† ν° λ¶„μ„**: λ΅κ·ΈμΈ μ”μ²­μ μ„Έμ… ν† ν°μ΄λ‚ μΏ ν‚¤ κ°’μ„ κ°€λ΅μ±„κ³  μμ •ν•΄ μ„Έμ… κ³ μ •(Session Fixation)μ΄λ‚ μ„Έμ… ν•μ΄μ¬ν‚Ή(Session Hijacking)κ³Ό κ°™μ€ κ³µκ²© κ°€λ¥μ„±μ„ λ¶„μ„ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, Interceptλ¥Ό ν†µν•΄ λ‹¤λ¥Έ μ‚¬μ©μλ΅ κ°€μ¥ν•  μ μλ”μ§€ ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

3. **λΈλ£¨νΈν¬μ¤ λ° λ°λ³µ μ”μ²­**: νΉμ • νλΌλ―Έν„°μ— λ€ν•΄ μ—¬λ¬ κ°’μ„ λ€μ…ν•΄ λ°λ³µμ μΌλ΅ μ”μ²­μ„ λ³΄λ‚΄μ•Ό ν•  λ•, Interceptμ™€ Burp Suiteμ λ‹¤λ¥Έ κΈ°λ¥μ„ μ΅°ν•©ν•΄ μ ν¨ν• μΈμ¦ μ •λ³΄λ¥Ό μ°Ύκ±°λ‚ νΉμ • μ‘λ‹µμ„ μ λ„ν•  μ μμµλ‹λ‹¤.

4. **ν΄λΌμ΄μ–ΈνΈ μΈ΅ λ°μ΄ν„° μ΅°μ‘**: ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„λ΅ μ „μ†΅λλ” λ°μ΄ν„°λ¥Ό κ°€λ΅μ±„κ³ , HTMLμ΄λ‚ JavaScriptμ ν•„λ“ κ°’μ„ μ΅°μ‘ν•μ—¬ μ„λ²„κ°€ μ–΄λ–»κ² λ°μ‘ν•λ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, λ΅κ·ΈμΈ ν™”λ©΄μ—μ„ μ¨κ²¨μ§„ μ…λ ¥ ν•„λ“μ κ°’μ„ μμ •ν•μ—¬ μ„λ²„μ μ‘λ‹µμ΄ λ³€ν•λ”μ§€ ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

5. **μ·¨μ•½μ  νƒμ§€ λ° ν…μ¤νΈ**: SQL μΈμ μ…, XSS λ“±κ³Ό κ°™μ€ μ…λ ¥ κΈ°λ° μ·¨μ•½μ μ„ νƒμ§€ν•λ” λ° μ μ©ν•©λ‹λ‹¤. κ°€λ΅μ± μ”μ²­μ—μ„ νλΌλ―Έν„° κ°’μ— μ•…μ„± νμ΄λ΅λ“λ¥Ό μ‚½μ…ν•΄ μ„λ²„μ μ‘λ‹µμ„ ν™•μΈν•¨μΌλ΅μ¨ μ·¨μ•½μ μ„ μ°Ύμ„ μ μμµλ‹λ‹¤.

# Burpsuite Intercept μ‚¬μ© μμ 

ν”„λ΅μ‹ μ„¤μ • μ™„λ£ ν›„, `burpsuite`μ `Proxy` νƒ­μ— μ ‘μ†ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ ν™”λ©΄μ„ λ³Ό μ μμµλ‹λ‹¤.

<p id="img_center">
  <img 
        src="../../assets/images/Security/11-01.PNG"
        alt="image"
        title="image"
  >
</p>

`Intercept is off` λ²„νΌμ„ ν΄λ¦­ν•λ©΄ ν•΄λ‹Ή λ²„νΌμ΄ `Intercept is on`μΌλ΅ λ³€κ²½λ©λ‹λ‹¤.

`Intercept is on` μƒνƒμ—μ„ μ›ΉλΈλΌμ°μ €λ΅ μ΄μ©ν•  μ‚¬μ΄νΈμ— μ”μ²­μ„ λ³΄λ‚΄λ©΄, μ”μ²­μ„ κ°€λ΅μ±„κ³  μ”μ²­ν• λ‚΄μ©μ„ λ³΄κ±°λ‚, μμ •ν•  μ μμµλ‹λ‹¤. 

## 1. User-Agent λ³€κ²½

λ„¤μ΄λ²„λ¥Ό μ ‘μ†ν•΄λ³΄λ©΄, PCμ™€ μ¤λ§νΈν°μ—μ„ μ¶λ ¥λλ” ν™”λ©΄μ κµ¬μ„±μ΄ λ‹¤λ¥Ό κ²ƒμ…λ‹λ‹¤. PCμ—μ„ μΈν„°μ…‰νΈλ¥Ό ν†µν•΄ PC `User-Agent`λ¥Ό μ¤λ§νΈν° `User-Agent`λ΅ λ³€κ²½ν•μ—¬ **μ”μ²­(request)**μ„ λ³΄λ‚΄λ©΄, λ„¤μ΄λ²„λ” μ¤λ§νΈν°μ— ν•΄λ‹Ήν•λ” ν™”λ©΄μ„ **μ‘λ‹µ(responde)**ν•  κ²ƒ μ…λ‹λ‹¤.

- `Intercept is on` μƒνƒμ—μ„ μ›ΉλΈλΌμ°μ €λ¥Ό ν†µν•΄ λ„¤μ΄λ²„(https://www.naver.com/)μ— μ ‘μ†ν•©λ‹λ‹¤.

- `burpsuite`μ΄ μ •λ³΄λ¥Ό <b>Intercept</b>ν•μ—¬, μ›Ή λΈλΌμ°μ €λ” λ„¤μ΄λ²„μ— μ ‘μ†μ΄ λμ§€ μ•μ§€λ§, `burpsuite`μ—λ” μ•„λ μ΄λ―Έμ§€μ™€ κ°™μ€ ν™”λ©΄μ΄ λ‚νƒ€λ‚  κ²ƒ μ…λ‹λ‹¤.

<p id="img_center">
  <img 
        src="../../assets/images/Security/11-02.PNG"
        alt="image"
        title="image"
  >
</p>

- λ‚΄μ©μ„ λ³΄λ©΄, λ‚μ `User-Agent`λ” `Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0` μ…λ‹λ‹¤. ν•΄λ‹Ή λ‚΄μ©μΌλ΅ μ ‘μ†ν•λ©΄, μΌλ°μ μΈ PCμ© λ„¤μ΄λ²„ ν™”λ©΄μ΄ μ¶λ ¥λ  κ²ƒμ…λ‹λ‹¤.

- `User-Agent`λ¥Ό **iPhone** `User-Agent`μΈ <small><u>Mozilla/5.0 (iPhone; CPU iPhone OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/120.0.6099.119 Mobile/15E148 Safari/604.</u></small>λ΅ λ³€κ²½ν•©λ‹λ‹¤.

- `User-Agent`μ μΆ…λ¥λ” λ‹¤μ κΉƒν—λΈλ¥Ό μ°Έμ΅°ν•μ„Έμ”.(π‘‰ [pzb/user-agents.txt](https://gist.github.com/pzb/b4b6f57144aea7827ae4))

<p id="img_center">
  <img 
        src="../../assets/images/Security/11-03.PNG"
        alt="image"
        title="image"
  >
</p>