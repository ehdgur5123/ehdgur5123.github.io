---
layout: single
title: "ln 명령어"
categories: Linux
tag: [Linux, ln]
permalink : /posts/LinuxCommand-ln/
classes : custom-style
toc: true
author_profile: false
sidebar:
  nav: "Linux"
---

<hr>

# ln 명령어

link의 약자로 파일이나 디렉토리의 링크를 생성하는 명령어.

링크의 종류에는 **하드 링크(Hard Link)**와 **심볼릭 링크(Symbolic Link)**가 있음

# 하드 링크와 심볼릭 링크

## 1. 하드 링크(Hard Link)

- 하드 링크는 같은 파일 시스템 내에서 원본 파일의 또 다른 이름을 만드는 방식

- 파일명이 다르지만, 동일한 데이터 블록을 참조하고 있음

- *한 쪽이 수정되면* 하드 링크된 파일들도 *함께 수정 됨*

- *한 쪽이 삭제되도* 다른 하드 링크가 데이터를 가지고 있으므로, *데이터에 접근이 가능함*

## 2. 심볼릭 링크(Symbolic Link)

- 윈도우(Window)의 바로가기와 같은 역할

- 파일이나 디렉토리의 경로를 참조하는 링크로 파일이나 디렉토리의 위치를 가리키는 포인터 역할을 함

- 심볼릭 링크는 단순히 경로를 저장하고 있을 뿐이므로, *원본 파일이 삭제되거나 경로가 바뀌면 링크가 유효하지 않게 됨*

- 심볼릭 링크는 `ls -l` 명령어를 사용하여 쉽게 확인할 수 있습니다. 심볼릭 링크는 파일 목록에서 화살표(->)와 함께 표시됩니다.

```bash
ls -l
>> lrwxrwxrwx 1 user user  18 Aug  9 12:34 link.txt -> /home/user/original.txt
```

## 3. 하드 링크와 심볼릭 링크의 차이

|        특징       |                         하드 링크                         |                    심볼릭 링크                    |
|:-----------------:|:---------------------------------------------------------:|:-------------------------------------------------:|
|     동작 방식     |              파일의 실제 데이터 블록을 가리킴             |       원본 파일이나 디렉토리의 경로를 가리킴      |
| 원본 파일 삭제 시 |         링크 파일이 계속 존재하고 데이터를 유지함         |           링크가 깨져서 유효하지 않게 됨          |
|  파일 시스템 제한 |               같은 파일 시스템 내에서만 동작              |    다른 파일 시스템이나 파티션에 대해 작동 가능   |
|   디렉토리 링크   |      디렉토리에 대한 하드 링크는 일반적으로 생성 불가     |       디렉토리에 대한 심볼릭 링크 생성 가능       |
|     파일 크기     | 동일한 데이터 블록을 공유하므로 추가 공간을 차지하지 않음 | 링크 파일 자체가 경로를 저장하는 작은 크기의 파일 |

# ln 명령어 기본 구문

```bash
ln [옵션] [원본 파일 또는 디렉토리] [링크 이름]
```

# ln 명령어 옵션

## 1. 하드 링크를 생성(옵션 미지정)

옵션 미지정 시 기본값으로 하드 링크를 생성

```bash
ln  /path/to/original /path/to/link
```

## 2. 심볼릭 링크 생성(-s)

심볼릭 링크를 생성하는 명령어 

```bash
ln -s /path/to/original /path/to/link
```

## 3. 파일 덮어쓰기(-f)

- *force*의 약자 

- 강제로 링크를 만듭니다. 이 옵션을 사용하면, 링크를 만들 위치에 이미 파일이 있더라도 해당 파일을 삭제하고 새로운 링크를 생성합니다.

- 심볼릭 링크와 하드 링크 모두에 사용할 수 있습니다.

- 하드 링크를 덮어쓰려면 `-f`, 심볼릭 링크를 덮어쓰려면 `-sf`

```bash
ln -sf /path/to/original /path/to/link
```

## 4. 상세 정보 출력(-v)

- *verbose*(말 수가 많은)의 약자

- 실행 중인 작업의 상세 정보를 출력

- 링크가 생성되면 어떤 링크가 생성되었는지 메시지가 출력됩니다

- 심볼릭 링크와 하드 링크 모두에 사용할 수 있습니다

- 하드 링크는 `-v`, 심볼릭 링크는 `-sv`

```bash
ln -sv /path/to/original /path/to/link
```

## 5. 파일로 취급(-T)

- "treat as a regular file"(일반 파일로 취급하십시오)의 약자

- 심볼링 링크에서만 쓰인다

- 예를 들어, 설명해보자

  A. 한 디렉토리에 original이라는 파일과 link라는 디렉토리가 있다.

    ```bash
    lee@lee:~/test$ ls
    link  original
    ```

  B. original 파일을 link라는 이름으로 심볼릭 링크를 만드려고 한다.

  C. `-T` 옵션을 주지 않으면 link 디렉토리 내부에 original이라는 심볼릭 링크 파일이 생성된다

    ```bash
    lee@lee:~/test$ ln -s original link
    
    lee@lee:~/test$ ls -R
    .:
    link  original

    ./link:
    original
    ```

  D. `-T` 옵션을 준다면, link 라는 디렉토리가 있으므로 심볼릭 링크를 만들 수 없을 것이다.

    ```bash
    lee@lee:~/test$ ln -sT original link
    ln: 'link' 심볼릭 링크 만들기 실패: 파일이 있습니다
    ```

- `-T` 옵션을 주지 않았을 때, 내부에 link라는 디렉토리가 있다면 ln 명령어는 link를 경로로 인식해서 link 내부에 원본 파일과 같은 이름의 original 파일을 생성

- `-T` 옵션을 주면 link를 파일로 취급하므로, 내부에 link라는 동일한 이름의 디렉토리가 존재하므로 심볼릭 링크 생성 불가

  > 리눅스에서는 같은 경로에 같은 이름의 파일과 디렉토리를 가질 수 없음

- 이는 다분히 사용자의 *실수를 방지하기 위한 옵션*으로, 원하지 않은 위치에 심볼릭 링크가 생성되는 것을 방지하거나, 경로를 명확히 지정하고 싶을 때 사용
