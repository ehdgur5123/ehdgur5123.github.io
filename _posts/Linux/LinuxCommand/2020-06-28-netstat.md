---
layout: single
title: "netstat 명령어"
categories: Linux
tag: [Linux, netstat]
permalink : /posts/LinuxCommand-netstat/
classes : custom-style
toc: true
author_profile: false
sidebar:
  nav: "Linux"
---

<hr>

# netstat 명령어

`netstat` 명령어는 Linux 및 Unix 계열 운영 체제에서 **네트워크 연결 상태, 네트워크 인터페이스 정보, 라우팅 테이블, 네트워크 통계** 등을 확인하는 데 사용되는 도구입니다. 시스템의 **TCP/UDP 포트 상태, 네트워크 트래픽 흐름, 네트워크 인터페이스 사용량** 등을 모니터링할 수 있습니다.

현재는 `ss` 명령어로 대체되는 추세이지만, 레거시 시스템에서는 여전히 `netstat`이 널리 사용됩니다.

## 1. netstat 명령어 기본 구문

```bash
netstat [옵션]
```

`netstat` 명령어는 네트워크 상태에 대한 정보를 조회하고, 옵션에 따라 네트워크 연결 상태, 포트 사용 현황, 라우팅 테이블, 네트워크 인터페이스 통계 등의 정보를 출력할 수 있습니다.

## 2. 주요 옵션 및 조건

### TCP 연결 정보 출력(-t)

`-t`: <b>TCP</b>의 약자로, 이 옵션을 사용하면 현재 시스템에서 **사용 중인 TCP 연결을 출력**할 수 있습니다. TCP는 연결 기반 통신 프로토콜로, 네트워크 연결 상태를 모니터링하는 데 사용됩니다.

```bash
netstat -t
```

예시: 활성화된 모든 TCP 연결 상태를 출력합니다.

### UDP 연결 정보 출력(-u)

`-u`: <b>UDP</b>의 약자로, 이 옵션은 **UDP 연결 상태를 확인**할 수 있습니다. UDP는 비연결형 통신 프로토콜로, TCP와 달리 연결 상태를 유지하지 않으며 실시간으로 네트워크 데이터를 송수신할 때 주로 사용됩니다.

```bash
netstat -u
```

예시: 활성화된 모든 UDP 연결 상태를 출력합니다.

### 리스닝 포트 확인(-l)

`-l`: <b>listening</b>의 약자로, 이 옵션을 사용하면 리스닝(열려 있는) 포트를 확인할 수 있습니다. 

**수신 대기 중인 서버**들의 정보만 표시되며, **현재 활성화된 인터넷 연결 및 도메인 소켓**들의 정보를 출력합니다. 

```bash
netstat -l
```

예시: 현재 리스닝 상태인 포트들을 확인합니다.

### 포트 번호 및 IP 주소를 숫자로 표시(-n)

`-n`: <b>numeric</b>(숫자)의 약자로, 이 옵션은 **포트 번호와 IP 주소를 숫자 형태로 표시**합니다. 기본적으로 `netstat` 명령어는 포트 번호와 IP 주소를 호스트 이름과 서비스 이름으로 변환하여 출력하는데, 숫자 그대로 출력할 때 사용합니다.

```bash
netstat -n
```

예시: 숫자 형식으로 포트 번호 및 IP 주소를 출력합니다.

### 네트워크 인터페이스 상태 확인(-i)

`-i`: <b>interface</b>의 약자로, 이 옵션을 사용하면 **네트워크 인터페이스의 상태를 확인**할 수 있습니다. 네트워크 인터페이스의 패킷 전송/수신 상태, 오류 등을 확인할 수 있으며, 현재 활성화된 인터페이스의 정보를 출력합니다.

```bash
netstat -i
```

예시: 네트워크 인터페이스의 상태와 트래픽 통계를 확인합니다.

### 라우팅 테이블 확인(-r)

`-r`: <b>route</b>의 약자로, 이 옵션을 사용하면 **현재 시스템의 라우팅 테이블을 출력**할 수 있습니다. 라우팅 테이블은 네트워크 트래픽이 어떤 경로로 이동하는지를 나타내며, 게이트웨이 정보 등도 포함됩니다.

```bash
netstat -r
```

예시: 라우팅 테이블을 출력하여 네트워크 트래픽의 경로를 확인합니다.

### 프로그램과 연결된 네트워크 정보 확인(-p)

`-p`: <b>program</b>의 약자로, 이 옵션을 사용하면 **네트워크 포트를 사용하는 프로그램의 정보도 함께 출력**할 수 있습니다. <u>특정 포트를 열고 있는 프로세스의 PID와 이름을 확인</u>할 수 있습니다.

```bash
netstat -p
```

예시: 특정 프로세스가 사용하는 포트와 네트워크 연결 정보를 출력합니다.

### 네트워크 통계 확인(-s)

`-s`: <b>statistics</b>(통계)의 약자로, 이 옵션은 **네트워크 통계 정보를 출력**합니다. 이는 <u>프로토콜별 통계(TCP, UDP, ICMP 등)</u>를 포함하며, 각 <u>프로토콜의 패킷 수, 전송/수신된 패킷, 오류 등의 정보</u>를 확인할 수 있습니다.

```bash
netstat -s
```

예시: 네트워크의 프로토콜별 통계를 출력합니다.

## 3. 출력 정보 확인하기
  
### netstat -t -u

```bash
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 lee:41984               1.80.190.35.bc.go:https ESTABLISHED
udp        0      0 lee:bootpc              _gateway:bootps         ESTABLISHED
```

#### Active Internet connections (w/o servers)

`Active Internet connections`은 현재 활성화된 인터넷 연결을 나타냄

`(w/o servers)`은 "without servers"의 약자로, 서버 역할을 하는 포트를 제외한 **클라이언트로서 연결된 상태만 표시**

#### 출력정보

1. **Proto**(Protocol) : `Proto`는 해당 네트워크 연결에 사용된 프로토콜을 나타냅니다.

  - `tcp`: 연결 기반 통신 (Transmission Control Protocol)
  - `udp`: 비연결 기반 통신 (User Datagram Protocol)

2. **Recv-Q**(Receive Queue) : `Recv-Q`는 <b>수신 대기열에 있는 데이터의 양</b>을 나타내며, 서버가 데이터를 아직 처리하지 않았을 때 이 값이 `0`이 아닌 숫자로 나타납니다.

  - `0`이면 수신 대기열에 쌓인 데이터가 없다는 의미 (정상 상태)
  - `0`보다 크면 시스템에서 처리가 지연되고 있음을 의미할 수 있습니다.

3. **Send-Q**(Send Queue) : `Send-Q`는 <b>전송 대기열에 있는 데이터의 양</b>을 나타냅니다. 시스템이 외부로 데이터를 보냈지만, 아직 전송이 완료되지 않았을 때 대기열에 쌓인 데이터를 의미합니다.

  - `0`이면 전송 대기열에 쌓인 데이터가 없다는 의미 (정상 상태)
  - `0`보다 크면 데이터 전송이 완료되지 않았음을 나타냅니다.

4. **Local Address** : <b>로컬 시스템</b>의 IP 주소 및 포트 번호를 의미합니다.

  - 예시: `192.168.0.1:80`
  - 포트 번호는 콜론(:) 뒤에 표시되며, 네트워크 서비스가 사용하는 포트를 나타냅니다.
  - 로컬 주소가 `0.0.0.0`인 경우, 이는 시스템의 모든 IP 주소에 대해 수신하는 상태를 의미합니다.

5. **Foreign Address** : <b>원격 시스템</b>의 IP 주소 및 포트 번호를 의미합니다.

  - 예시: `192.168.0.100:443`
  - 이 컬럼은 시스템이 통신하고 있는 외부 IP와 포트를 나타냅니다.
  - 외부 시스템의 IP와 포트 정보가 콜론(:)으로 구분되어 표시됩니다.

6. **State** : State는 해당 <b>TCP 연결의 상태</b>를 나타냅니다. UDP는 비연결형 프로토콜이므로 상태가 없을 수 있습니다.

  - `LISTEN`: 서버가 연결을 대기하고 있는 상태 (수신 대기 중)
  - `ESTABLISHED`: 연결이 활성화된 상태 (데이터 송수신 가능)
  - `CLOSE_WAIT`: 원격 호스트에서 연결을 닫았으나, 로컬 호스트에서 아직 닫지 않은 상태
  - `TIME_WAIT`: 연결이 종료된 후, 커넥션을 재사용하기 전에 대기 중인 상태
  - `SYN_SENT`: 클라이언트가 서버에 연결 요청을 보낸 상태 (SYN 패킷 전송)
  - `SYN_RECV`: 서버가 클라이언트의 연결 요청을 받고 대기 중인 상태

### netstat -l

```bash
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 localhost:domain        0.0.0.0:*               LISTEN 

Active UNIX domain sockets (only servers)
Proto RefCnt Flags       Type       State         I-Node   Path
unix  2      [ ACC ]     STREAM     LISTENING     32857    /tmp/.com.google.Chrome.VM22Sh/SingletonSocket
```

#### Active Internet connections (only servers)

#### Active UNIX domain sockets (only servers)
